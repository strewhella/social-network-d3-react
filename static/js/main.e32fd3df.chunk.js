(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(t,e,n){t.exports=n(24)},20:function(t,e,n){},24:function(t,e,n){"use strict";n.r(e);var r=n(1),o=n.n(r),a=n(12),i=n.n(a),c=(n(20),n(9)),s=n.n(c),u=n(14),l=n(13),h=n(4),d=n(5),f=n(7),p=n(6),g=n(3),v=n(8),m=n(2),y=function(t){function e(t){var n;return Object(h.a)(this,e),(n=Object(f.a)(this,Object(p.a)(e).call(this,t))).adding=void 0,n.onAdd=n.onAdd.bind(Object(g.a)(n)),n.onSearch=n.onSearch.bind(Object(g.a)(n)),n}return Object(v.a)(e,t),Object(d.a)(e,[{key:"render",value:function(){var t=this.props,e=t.onClear,n=t.search;return r.createElement(r.Fragment,null,r.createElement("h1",{className:"title"},"The Social Network"),r.createElement("a",{className:"button add",onClick:this.onAdd},r.createElement("div",null,"+")),r.createElement("a",{className:"button clear",onClick:e},r.createElement("div",null,"-")),r.createElement("input",{className:"search",type:"text",placeholder:"Search",onChange:this.onSearch,value:n}))}},{key:"onAdd",value:function(){var t=this;this.adding||(this.adding=!0,this.props.onAdd(),setTimeout(function(){t.adding=!1},1e3))}},{key:"onSearch",value:function(t){this.props.onSearch(t.target.value)}}]),e}(r.PureComponent),b=n(0),w=b.k("exit").ease(b.a).duration(400),j=b.k("enter").ease(b.b).duration(400),O=b.k("change").ease(b.c).duration(600),k=function(t){var e={};return t.forEach(function(t){t.tags.forEach(function(t){var n=Object.keys(e).find(function(e){return e.toLowerCase()===t.toLowerCase()});n&&(t=n),e[t]||(e[t]=0),e[t]++})}),Object.keys(e).map(function(t){var n=Object(m.random)(150,220);return{tag:t,count:e[t],color:"rgb(".concat(n,",").concat(n,",").concat(n,")")}})},x=function(t,e){var n={};return Object(m.cloneDeep)(t).concat(Object(m.cloneDeep)(e)).forEach(function(t){var e=t.tag.toLowerCase();n[e]?n[e].count+=t.count:n[e]=t}),Object.keys(n).map(function(t){return n[t]})},S=function(t,e){var n=Object(m.random)(0,255),r=Object(m.random)(0,255),o=Object(m.random)(0,255),a="rgb(".concat(n,",").concat(r,",").concat(o,")");return e[t]={id:t,tags:new Set,radius:0,following:new Set,followed:new Set,color:a},e[t]},E=function(t,e,n){return Math.max(e,Math.min(n-e,t))},P=function(t){return":"===t[t.length-1]&&(t=t.substring(0,t.length-1)),t},C=Math.PI/2,A=function(t){function e(t){var n;Object(h.a)(this,e),(n=Object(f.a)(this,Object(p.a)(e).call(this,t))).circleGroup=void 0,n.triangleGroup=void 0,n.simulation=void 0;var r=t.people,o=t.follows,a=t.center;return n.simulation=b.h(r).force("links",b.f(o).id(function(t){return t.id}).distance(function(t){return t.source.radius+t.target.radius+10}).strength(0)).force("center",b.d(a.x,a.y)).force("charge",b.g().strength(-1)).force("collide",b.e().radius(function(t){return t.radius})),n}return Object(v.a)(e,t),Object(d.a)(e,[{key:"render",value:function(){var t=this,e=this.props,n=e.width,o=e.height,a=e.center,i=e.people,c=e.follows,s=e.onHover;i.forEach(function(t){t.x=t.x||Object(m.random)(a.x-50,a.x+50),t.y=t.y||Object(m.random)(a.y-50,a.y+50)}),this.simulation.nodes(i),this.simulation.force("links").links(c),this.simulation.alpha(1).restart();var u=b.i(this.circleGroup).selectAll("circle").data(i,function(t){return t.id+""});u.exit().on("mouseover",null).on("mouseout",null).transition(w).style("transform","scale(0)").remove();var l=u.enter().append("circle");l.style("transform","scale(0)").attr("fill","#000000").attr("stroke",function(t){return t.color}).attr("stroke-width",function(t){return t.radius/4}).attr("data-id",function(t){return"id-".concat(t.id)}).transition(j).style("transform-origin","center").style("cursor","pointer").style("transform","scale(1)"),u=l.merge(u).on("mouseover",function(t){b.j("circle").each(function(e){b.i(this).attr("opacity",t.id===e.id||t.following.has(e.id)?1:.1)}),b.j("polygon").each(function(e){b.i(this).attr("opacity",t.id===e.source.id?1:.05)}),b.j("[data-id=id-".concat(t.id,"]")).attr("fill",t.color),s(t.id)}).on("mouseout",function(t){b.j("circle[data-id=id-".concat(t.id,"]")).attr("fill","#000000"),b.j("polygon[data-id=id-".concat(t.id,"]")).attr("fill","#B8B8B8"),b.j("circle").attr("opacity",1),b.j("polygon").attr("opacity",1),s()}).attr("r",function(t){return t.radius}).attr("cx",a.x).attr("cy",a.y).attr("fill",function(t){return t.hovering?t.color:"#000000"});var h=b.i(this.triangleGroup).selectAll("polygon").data(c);h.exit().transition(w).style("transform-origin","center").style("transform","scale(0)").remove();var d=h.enter().append("polygon").style("cursor","pointer").attr("data-id",function(t){return"id-".concat(t.source.id)});return h=d.merge(h).attr("fill",function(t){return t.hovering?t.color:"#B8B8B8"}),this.simulation.nodes(i).on("tick",function(){u.attr("cx",function(t){return E(t.x,t.radius,n)}).attr("cy",function(t){return E(t.y,t.radius,o)}),h.attr("points",function(t){var e=E(t.source.x,t.source.radius,n),r=E(t.source.y,t.source.radius,o),a=E(t.target.x,t.target.radius,n),i=E(t.target.y,t.target.radius,o),c=Math.atan2(i-r,a-e),s=Math.cos(c)*-t.target.radius+a,u=Math.sin(c)*-t.target.radius+i,l=t.source.radius/6,h=Math.cos(c+C)*l+e,d=Math.cos(c-C)*l+e,f=Math.sin(c+C)*l+r,p=Math.sin(c-C)*l+r;return"".concat(h,",").concat(f," ").concat(d,",").concat(p," ").concat(s,",").concat(u)})}),r.createElement("svg",{width:n,height:o},r.createElement("g",{ref:function(e){return t.triangleGroup=e}}),r.createElement("g",{ref:function(e){return t.circleGroup=e}}))}}]),e}(r.PureComponent),F=window.innerWidth/20,q=function(t){function e(t){var n;return Object(h.a)(this,e),(n=Object(f.a)(this,Object(p.a)(e).call(this,t))).svg=void 0,n.simulation=void 0,n.state={},n.simulation=n.createSimulation(),n}return Object(v.a)(e,t),Object(d.a)(e,[{key:"componentWillReceiveProps",value:function(t){(this.props.hoverPerson&&!t.hoverPerson||!this.props.hoverPerson&&t.hoverPerson||this.props.search!==t.search)&&this.setState({interacting:!0}),!this.state.interacting||this.props.hoverPerson||t.hoverPerson||this.props.search!==t.search||this.setState({interacting:!1}),0===this.props.tagFrequencies.length&&t.tagFrequencies.length>0&&(this.simulation=this.createSimulation())}},{key:"render",value:function(){var t=this,e=this.props,n=e.width,o=e.height,a=e.tagFrequencies,i=e.hoverPerson,c=e.center,s=e.search,u=this.state.interacting,l=b.i(this.svg).selectAll("text").data(a,function(t){return t.tag}),h=l.enter().append("text").style("transform-origin","center").attr("x",function(t){return Object(m.random)(F,n-F)}).attr("y",function(t){return Object(m.random)(F,o-F)});h.transition(j).style("transform","scale(1)");var d=l.exit();d.interrupt("exit"),d.transition(w).style("transform","scale(0)").remove();var f=b.k("words").duration(1e3),p=h.merge(l).text(function(t){return t.tag}),g=s&&function(t,e){return t.filter(function(t){return t.tag.toLowerCase().includes(e.toLowerCase())}).map(function(t){return t.tag})}(a,s)||[];return p.interrupt("change"),p.transition(O).attr("fill",function(t){return i&&i.tags.has(t.tag)||s&&g.some(function(e){return t.tag===e})?"#000000":t.color}).attr("opacity",function(t){return i&&!i.tags.has(t.tag)||s&&!g.some(function(e){return t.tag===e})?.05:1}),u||(a.forEach(function(t){t.x=Object(m.random)(c.x-F,c.x+F),t.y=Object(m.random)(c.y-F,c.y+F)}),this.simulation.nodes(a),this.simulation.tick(3),this.simulation.stop()),p.transition(f).attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("font-size",function(t){return 3*t.count+6+"px"}),r.createElement("svg",{ref:function(e){return t.svg=e},width:n,height:o})}},{key:"createSimulation",value:function(){var t=this.props,e=t.tagFrequencies,n=t.center;return b.h(e).force("center",b.d().x(n.x).y(n.y)).force("charge",b.g().strength(-window.innerHeight/4)).force("collide",b.e().strength(50))}}]),e}(r.PureComponent),M=function(t){function e(t){var n;Object(h.a)(this,e),n=Object(f.a)(this,Object(p.a)(e).call(this,t));var r=window.innerWidth,o=window.innerHeight,a={x:r/2,y:o/2};return n.state={people:{},follows:[],width:r,height:o,center:a,tagFrequencies:[],search:""},n.onAdd=n.onAdd.bind(Object(g.a)(n)),n.onClear=n.onClear.bind(Object(g.a)(n)),n.onResize=n.onResize.bind(Object(g.a)(n)),n.onHoverPerson=n.onHoverPerson.bind(Object(g.a)(n)),n.onSearch=n.onSearch.bind(Object(g.a)(n)),n}return Object(v.a)(e,t),Object(d.a)(e,[{key:"componentDidMount",value:function(){this.onAdd(),window.addEventListener("resize",this.onResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.onResize)}},{key:"render",value:function(){var t=this.state,e=t.width,n=t.height,r=t.follows,a=t.center,i=t.hoveringPerson,c=t.people,s=t.tagFrequencies,u=t.search;return o.a.createElement(o.a.Fragment,null,o.a.createElement(q,{width:e,height:n,center:a,hoverPerson:i,tagFrequencies:s,search:u}),o.a.createElement(A,{people:c.list||[],follows:r,width:e,height:n,center:a,onHover:this.onHoverPerson}),o.a.createElement(y,{onAdd:this.onAdd,onClear:this.onClear,onSearch:this.onSearch,search:u}))}},{key:"onResize",value:function(){var t=window.innerWidth,e=window.innerHeight,n={x:t/2,y:e/2};this.setState({width:t,height:e,center:n})}},{key:"onAdd",value:function(){var t=Object(l.a)(s.a.mark(function t(){var e,n,r,o,a,i,c,l;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,store.sample();case 3:return e=t.sent,n=Object(u.a)({},this.state.people),r=Object(m.uniq)(e.reduce(function(t,e){return t.concat(e)},[])),o=r.filter(function(t){return!n[t]}),t.next=9,store.tags(o);case 9:a=t.sent,i=o.map(function(t,e){var r=S(t,n);return r.tags=new Set(a[e].map(P)),r.radius=.3*r.tags.size+4,r}),n.list=Object.keys(n).filter(function(t){return"list"!==t}).map(function(t){return n[t]}),e.forEach(function(t){var e=n[t[0]],r=n[t[1]];e.following.add(r.id),r.followed.add(e.id)}),c=k(i),l=x(this.state.tagFrequencies,c),this.setState({people:n,tagFrequencies:l,follows:this.state.follows.concat(e.map(function(t){return{source:t[0],target:t[1]}}))}),t.next=21;break;case 18:t.prev=18,t.t0=t.catch(0),console.error(t.t0);case 21:case"end":return t.stop()}},t,this,[[0,18]])}));return function(){return t.apply(this,arguments)}}()},{key:"onHoverPerson",value:function(t){var e=this.state.people;this.setState({hoveringPerson:e[t]})}},{key:"onClear",value:function(){this.setState({people:{},follows:[],tagFrequencies:[],search:""})}},{key:"onSearch",value:function(t){this.setState({search:t})}}]),e}(r.Component);i.a.render(o.a.createElement(M,null),document.getElementById("root"))}},[[15,1,2]]]);
//# sourceMappingURL=main.e32fd3df.chunk.js.map